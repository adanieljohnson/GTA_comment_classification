---
title: "DOCX Comment Extraction"
author: "Dan Johnson"
date: "2/22/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

The testing dataset used in this project was created using BaSH scripting and one-off tools. This page documents progress on a workflow to replicate that process using R tools.

####\  

#General Approach
Create a list of files to cycle through OR put all files to process in ONE folder. For each file, use 'read_docx', then 'docx_extract_all_cmnts'. Use 'do.call("rbind", list(dataframes to merge))' to cycle through and append the extracted comments to ONE dataframe

####\  

#Code Sources, Examples

https://stackoverflow.com/questions/50439684/how-to-extract-plain-text-from-docx-file-using-r

https://stackoverflow.com/questions/5965698/merge-unequal-dataframes-and-replace-missing-rows-with-0

https://stat.ethz.ch/R-manual/R-devel/library/base/html/merge.html

https://www.dummies.com/programming/r/how-to-use-the-merge-function-with-data-sets-in-r/

https://datascienceplus.com/combining-data-in-r-the-skill-of-merging-joining-and-stacking/

https://www.rdocumentation.org/packages/analogue/versions/0.17-1/topics/join
Load required Libraries

####\  

#Sample Working Code
```{r}
library(docxtractr)
```

Call in Word files using ```read_docx```. Use ```docx_extract_all_cmts``` to pull out comments and ```rbind``` to combine them. 

To merge more than two dataframes within R, combine an ```rbind``` call with ```do.call```. The 'do.call' function uses any existing R functions, such as 'rbind', but instead of passing just two dataframes, it passes multiple data frames. Then use ```write.csv2``` to write the data to a CSV format.

```{}
Commentframe1<-read_docx("/Users/danjohnson/Dropbox/Coding_Tools/R_Environment/R_Projects/DOCX_comment_extraction/TestingReport.docx", track_changes = NULL)
comments1<-docx_extract_all_cmnts(Commentframe1, include_text = FALSE)

Commentframe2<-read_docx("/Users/danjohnson/Dropbox/Coding_Tools/R_Environment/R_Projects/DOCX_comment_extraction/TestingCommentExtraction.docx", track_changes = NULL)
comments2<-docx_extract_all_cmnts(Commentframe2, include_text = FALSE)

# comments1And2 <- rbind(comments1,comments2)
# OR
# comments1And2 <- do.call("rbind", list(comments1,comments2))

#Check data have been successfully merged by checking the number of rows
NROW(comments1And2)
# [1] 32

#When all lines are appended, write the CSV file 
write.csv2(comments1And2, file = "TAcomments.csv")

```
